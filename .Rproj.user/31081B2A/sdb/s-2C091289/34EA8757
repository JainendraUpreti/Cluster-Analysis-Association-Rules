{
    "collab_server" : "",
    "contents" : "# Cincinnati Zoo Dataset Cluster Analysis and Association Rules\n\n## loading required libraries\n\nlibrary(fpc) # cluster analysis\nlibrary(mclust) # model based clustering\nlibrary(arules) #to setup the association rules\nlibrary(arulesViz) #to implement visualization techniques to explore association rule\nlibrary(tidyr) # Data manipulation\nlibrary(dplyr) # Data manipulation\nlibrary(ggplot2) # Plots\n\n## Reading the data from the sources\n\n### data for cluster Analysis\nzooc <- read.csv(\"J:/Data Analysis/Git Hub/AssociationRules/qry_Food_by_Month.csv\")\n\n### Data for Setting up Association Rules\nTransFood <- read.csv('http://homepages.uc.edu/~maifg/DataMining/data/food_4_association.csv')\n\n# Exploring ZOOC data set\nstr(zooc)\nsummary(zooc)\n### The zooc data set comprises of 55 data points and has 7 variables. The first column\n### contains the items that are sold in the zoo (there are total 55 distinct items) and the\n### showcase the sale of an item over a period of 6 months starting from October 2010 to\n### March 2011\n\n## Check for NAs in the dataset\ncheck_na <- sum(is.na(zooc))\ncheck_na # No missing values in the dataset\n\n## check for NANs, since is.nan can't be applied to a dataframe we use the below function\ncheck_nan <- function(x)\n  do.call(cbind, lapply(x, is.nan))\ncheck_nan(zooc) #no missing values in the dataset\n\n#boxplot\nboxplot(zooc[,-1], ylab = 'Sales', xlab = 'months', col = rainbow(unique(6)),\n        at = c(1:6)-c(1, 1.5, 2, 2.5, 3, 3.5), boxwex = 0.3, xaxt = \"n\")\n# for october, december and march, we can observe a few outliers in the sales\nlegend(\"topright\", legend = c(\"Oct'10\", \"Nov'10\",\"Dec'10\", \"Jan'11\", \"Feb'11\", \"Mar'11\"),\n       fill = rainbow(unique(6)), cex = 0.70)\n?legend\n\n#barplot to observe the sales over months\nTot_vect <- colSums(zooc[,-1])\nTot_vect\n\nbarplot(Tot_vect, las = 0.5,yaxt = \"n\",ylim = c(0, 20000), ylab = \"Sales\", xlab = \"months\", \n        col = rainbow(unique(6)), width = 0.8, space = 0.3)\naxis(side = 2, at = seq(0, 20000, 2500), labels = TRUE, las = 0.5)\nbox()\n## the sales observed in the month of october far exceeds the sales observed in other months\n\n####################### Cluster Analysis ###########################\n\n#Preparing the data for cluster analysis\nzooc_norm <- scale(zooc[,-1]) #normalizing the data \nsummary(zooc_norm)\nzooc_norm <- as.data.frame(zooc_norm)\nstr(zooc_norm)\n\n## K-means clustering\n\nwss <- (nrow(zooc_norm)-1)*sum(apply(zooc_norm,2,var))\nfor (i in 2:12) wss[i] <- sum(kmeans(zooc_norm,\n                                     centers=i)$withinss)\nplot(1:12, wss, type=\"b\", xlab=\"Number of Clusters\",ylab=\"Within groups sum of squares\")\n\n### Finding the best cluster size\n\n### Prediction strength\nprediction.strength(zooc_norm, Gmin=2, Gmax=15, M=50,cutoff=0.8)\n\n### Silhouetee coefficient and dunn index ####\nd <- dist(zooc_norm, method = \"euclidean\")\nresult <- matrix(nrow = 14, ncol = 3)\nfor (i in 2:15){\n  cluster_result = kmeans(zooc_norm, i)\n  clusterstat=cluster.stats(d, cluster_result$cluster)\n  result[i-1,1]=i\n  result[i-1,2]=clusterstat$avg.silwidth\n  result[i-1,3]=clusterstat$dunn   \n}\nplot(result[,c(1,2)], type=\"l\", ylab = 'silhouette width', xlab = 'number of clusters')\nplot(result[,c(1,3)], type=\"l\", ylab = 'dunn index', xlab = 'number of clusters')\n\n#the best cluster size choice seems to be 3. Calculating other parameters for this size\n\nzooc_norm3=kmeans(zooc_norm,3)\nplotcluster(zooc_norm, zooc_norm3$cluster)\ntable(zooc_norm3$cluster)\nzooc_norm3$tot.withinss\nzooc_norm3$betweenss\nzooc_norm3$totss\n\n#Hierarchical Clustering using Ward method\n\ndis = dist(zooc_norm)\nhier_ward=hclust(dis, method=\"ward.D2\")\nplot(hier_ward)\nhier_ward.cut=cutree(hier_ward,3)\nrect.hclust(hier_ward, k=3, border = \"blue\")\nplotcluster(zooc_norm,hier_ward.cut)\ntable(hier_ward.cut)\n\n#Model Clustering\n\nmclust_result=Mclust(zooc_norm)\nsummary(mclust_result)\n\nplot(mclust_result)\n\n\n#################### Associatoin Rules #################\n\n## Working on the second dataset TransFood \nView(TransFood)\n\n# first column not required\n\nTransFood <- TransFood[, -1]\nTransFood <- as(as.matrix(TransFood), \"transactions\")\nTransFood\nsummary(TransFood)\n\n\n# plotting relative item frequency to find support to be taken to setup association rules\nitemFrequencyPlot(TransFood, support = 0.1, cex.names=0.8, col= \"blue\")\n\n## Association rule using Apriori Algorithm: Support = 3% and confindence = 50%\nbasket_rules <- apriori(TransFood,parameter = list(sup = 0.003, conf = 0.5,target=\"rules\"))\n\nsummary(basket_rules) #the mean value for lift is around 8.9\ninspect(head(basket_rules))\n\n#only list rules for which lift value is greater than 8.9\ninspect(subset(basket_rules,lift>8.9))\n\n# Plot for 42 rules\nplot(basket_rules, interactive=T)\n\n#Graph for 10 rules\nplot(head(sort(basket_rules, by=\"lift\"), 10), method = \"graph\")\n\n#Grouped matrix for 42 rules\nplot(basket_rules, method=\"grouped\")\n",
    "created" : 1497993129495.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2411497534",
    "id" : "34EA8757",
    "lastKnownWriteTime" : 1498076493,
    "last_content_update" : 1498076493880,
    "path" : "J:/Data Analysis/Git Hub/AssociationRules/Cincinnati Zoo Analysis.R",
    "project_path" : "Cincinnati Zoo Analysis.R",
    "properties" : {
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}